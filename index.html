<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Mercury Müşteri ve İşlem Takip Sistemi</title>
    <link rel="stylesheet" href="style.css?v=1.1">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-rocket"></i> Mercury</h1>
            <p>Müşteri ve İşlem Takip Sistemi</p>
        </header>

        <!-- Tab Sistemi -->
        <div class="tab-container">
            <div class="tab-header">
                <button class="tab-btn active" data-tab="customer">
                    <i class="fas fa-user-plus"></i>
                    <span>Müşteri Ekle</span>
                </button>
                <button class="tab-btn" data-tab="work">
                    <i class="fas fa-tools"></i>
                    <span>İşlem Ekle</span>
                </button>
                <button class="tab-btn" data-tab="payment">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Ödeme Ekle</span>
                </button>
                <button class="tab-btn" data-tab="list">
                    <i class="fas fa-list"></i>
                    <span>İşlemler</span>
                </button>
            </div>

            <!-- Tab İçerikleri -->
            <div class="tab-content">
                <!-- Müşteri Ekleme Tab -->
                <div class="tab-panel active" id="customer-tab">
                    <div class="form-card">
                        <h3><i class="fas fa-user-plus"></i> Yeni Müşteri Ekle</h3>
                        <form id="customerForm">
                            <input type="text" id="customerName" placeholder="Müşteri adı" required>
                            <input type="tel" id="customerPhone" placeholder="Telefon (opsiyonel)">
                            <textarea id="customerAddress" placeholder="Adres (opsiyonel)"></textarea>
                            <button type="submit" class="btn-save">
                                <i class="fas fa-save"></i> Müşteriyi Kaydet
                            </button>
                        </form>
                    </div>
                </div>

                <!-- İşlem Ekleme Tab -->
                <div class="tab-panel" id="work-tab">
                    <div class="form-card">
                        <h3><i class="fas fa-tools"></i> Yeni İşlem Ekle</h3>
                        <form id="workForm">
                            <select id="selectedCustomer" required>
                                <option value="">Müşteri seçin</option>
                            </select>
                            <input type="date" id="workDate" required>
                            <input type="text" id="materialType" placeholder="Malzeme türü yazın (örn: Ahşap, MDF, Lamine...)" required>
                            <input type="text" id="paintType" placeholder="Boya türü yazın (örn: Su bazlı, Yağ bazlı, Vernik...)" required>
                            <textarea id="workDescription" placeholder="Yapılan iş" required></textarea>
                            <div class="input-row">
                                <input type="number" id="workQuantity" step="1" min="1" placeholder="Adet" value="1" required>
                                <input type="number" id="workUnitPrice" step="0.01" min="0" placeholder="Adet Fiyatı (₺)" required>
                            </div>
                            <div class="total-price-display">
                                <span>Toplam Fiyat: </span>
                                <span id="totalPriceDisplay">₺0.00</span>
                            </div>
                            <button type="submit" class="btn-save">
                                <i class="fas fa-plus"></i> İşlemi Kaydet
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Ödeme Ekleme Tab -->
                <div class="tab-panel" id="payment-tab">
                    <div class="form-card">
                        <h3><i class="fas fa-money-bill-wave"></i> Yeni Ödeme Ekle</h3>
                        <form id="paymentForm">
                            <select id="paymentCustomer" required>
                                <option value="">Müşteri seçin</option>
                            </select>
                            <input type="date" id="paymentDate" required>
                            <input type="number" id="paymentAmount" step="0.01" min="0" placeholder="Tutar (₺)" required>
                            <select id="paymentMethod" required>
                                <option value="">Ödeme yöntemi</option>
                                <option value="Nakit">Nakit</option>
                                <option value="Kredi Kartı">Kredi Kartı</option>
                                <option value="Banka Havalesi">Banka Havalesi</option>
                                <option value="Çek">Çek</option>
                                <option value="Diğer">Diğer</option>
                            </select>
                            <textarea id="paymentNote" placeholder="Not (opsiyonel)"></textarea>
                            <button type="submit" class="btn-save">
                                <i class="fas fa-check"></i> Ödemeyi Kaydet
                            </button>
                        </form>
                    </div>
                </div>

                <!-- İşlemler Listesi Tab -->
                <div class="tab-panel" id="list-tab">
                    <div class="list-content">
                        <!-- Özet Kartı -->
                        <div class="summary-card">
                            <h3><i class="fas fa-chart-bar"></i> Genel Özet</h3>
                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-number" id="totalCustomers">0</div>
                                    <div class="stat-label">Müşteri</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="totalWorks">0</div>
                                    <div class="stat-label">İşlem</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="totalAmount">₺0</div>
                                    <div class="stat-label">Toplam</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="totalDebt">₺0</div>
                                    <div class="stat-label">Borç</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="totalPaid">₺0</div>
                                    <div class="stat-label">Ödenen</div>
                                </div>
                            </div>
                        </div>

                        <!-- Gelişmiş Arama ve Filtreleme -->
                        <div class="search-card">
                            <h3><i class="fas fa-search"></i> Müşteri Arama ve Filtreleme</h3>
                            <div class="search-controls">
                                <div class="search-box">
                                    <input type="text" id="searchCustomer" placeholder="Müşteri adı, telefon veya adres ara...">
                                    <button id="clearSearch" class="btn-clear">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="filter-controls">
                                    <select id="debtFilter">
                                        <option value="all">Tüm Müşteriler</option>
                                        <option value="debt">Borcu Olanlar</option>
                                        <option value="no-debt">Borcu Olmayanlar</option>
                                        <option value="overpaid">Fazla Ödeme Yapanlar</option>
                                    </select>
                                    <select id="sortBy">
                                        <option value="name">İsme Göre</option>
                                        <option value="debt">Borca Göre</option>
                                        <option value="works">İşlem Sayısına Göre</option>
                                        <option value="recent">Son İşlem Tarihine Göre</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Seçili Müşteri Detayları -->
                            <div id="customerDebtInfo" class="debt-info" style="display: none;">
                                <div class="debt-header">
                                    <i class="fas fa-user"></i>
                                    <span id="selectedCustomerName"></span>
                                    <div class="customer-actions">
                                        <button id="viewCustomerDetails" class="btn-view">
                                            <i class="fas fa-eye"></i> Detayları Gör
                                        </button>
                                        <button id="deleteCustomer" class="btn-delete-small">
                                            <i class="fas fa-trash"></i> Müşteriyi Sil
                                        </button>
                                    </div>
                                </div>
                                <div class="debt-amounts">
                                    <div class="debt-item">
                                        <span>Toplam Borç:</span>
                                        <span class="debt-amount" id="customerTotalDebt">₺0.00</span>
                                    </div>
                                    <div class="debt-item">
                                        <span>Ödenen:</span>
                                        <span class="paid-amount" id="customerTotalPaid">₺0.00</span>
                                    </div>
                                    <div class="debt-item">
                                        <span>Kalan:</span>
                                        <span class="remaining-debt" id="customerRemainingDebt">₺0.00</span>
                                    </div>
                                    <div class="debt-item">
                                        <span>İşlem Sayısı:</span>
                                        <span class="work-count" id="customerWorkCount">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Müşteri Listesi -->
                        <div class="list-card">
                            <div class="list-header">
                                <h3><i class="fas fa-users"></i> <span id="customerListTitle">Kayıtlı Müşteriler</span></h3>
                                <div class="customer-actions-header">
                                    <button id="exportCustomersExcel" class="btn-export">
                                        <i class="fas fa-file-excel"></i> Müşteri Listesi
                                    </button>
                                    <button id="exportDebtReport" class="btn-export">
                                        <i class="fas fa-file-invoice"></i> Borç Raporu
                                    </button>
                                </div>
                            </div>
                            <div id="customerList" class="customer-list">
                                <div class="empty-state">
                                    <i class="fas fa-user-plus"></i>
                                    <p>Henüz müşteri eklenmemiş</p>
                                </div>
                            </div>
                        </div>

                        <!-- İşlemler Listesi -->
                        <div class="list-card">
                            <div class="list-header">
                                <h3><i class="fas fa-list"></i> <span id="listTitle">Tüm İşlemler</span></h3>
                                <div class="action-buttons">
                                    <button id="exportExcel" class="btn-export">
                                        <i class="fas fa-file-excel"></i> Excel Aktar
                                    </button>
                                </div>
                            </div>
                            <div id="workList" class="work-list">
                                <div class="empty-state">
                                    <i class="fas fa-inbox"></i>
                                    <p>Henüz işlem eklenmemiş</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Popup -->
    <div id="customerDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user"></i> Müşteri Detayları</h3>
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Müşteri detayları buraya yüklenecek -->
            </div>
            <div class="modal-footer">
                <button class="btn-close" id="modalCloseBtn">
                    <i class="fas fa-check"></i> Tamam
                </button>
            </div>
        </div>
    </div>

    <!-- Silme Onay Modal -->
    <div id="deleteConfirmModal" class="modal">
        <div class="modal-content delete-modal">
            <div class="modal-header delete-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Müşteri Silme Onayı</h3>
                <button class="modal-close" id="closeDeleteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="deleteModalBody">
                <!-- Silme onay içeriği buraya yüklenecek -->
            </div>
            <div class="modal-footer delete-footer">
                <button class="btn-cancel" id="cancelDeleteBtn">
                    <i class="fas fa-times"></i> İptal
                </button>
                <button class="btn-delete" id="confirmDeleteBtn">
                    <i class="fas fa-trash"></i> Sil
                </button>
            </div>
        </div>
    </div>

    <!-- İşlem Silme Onay Modal -->
    <div id="deleteWorkConfirmModal" class="modal">
        <div class="modal-content delete-modal">
            <div class="modal-header delete-header">
                <h3><i class="fas fa-exclamation-triangle"></i> İşlem Silme Onayı</h3>
                <button class="modal-close" id="closeDeleteWorkModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="deleteWorkModalBody">
                <!-- İşlem silme onay içeriği buraya yüklenecek -->
            </div>
            <div class="modal-footer delete-footer">
                <button class="btn-cancel" id="cancelDeleteWorkBtn">
                    <i class="fas fa-times"></i> İptal
                </button>
                <button class="btn-delete" id="confirmDeleteWorkBtn">
                    <i class="fas fa-trash"></i> Sil
                </button>
            </div>
        </div>
    </div>

    <script src="script.js?v=1.1"></script>
</body>
</html>